{
  "dockerfile": "Dockerfile2",
  "total_issues": 104,
  "issues": [
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP086BFB42",
      "title": "ENV",
      "severity": "MEDIUM",
      "message": "Manual review is required to ensure ENV instructions are used effectively for setting version numbers, and to verify that environment variables are unset in a single layer using RUN commands to avoid persisting unwanted values.",
      "suggestion": "Use ENV to set the PATH environment variable and other necessary environment variables for your application. Consider consolidating ENV instructions to reduce layers when possible. For version numbers, use ENV to make updates easier. To unset an environment variable, use a RUN command with shell commands to set, use, and unset the variable in a single layer for better security and efficiency."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP08E4DA4E",
      "title": "CMD",
      "severity": "HIGH",
      "message": "Manual review is required to ensure CMD is used in the correct form for service-based images or for providing an interactive shell, and not just parameters without ENTRYPOINT unless specifically intended.",
      "suggestion": "Ensure CMD is used in the exec form, such as CMD [\"executable\", \"param1\", \"param2\"], especially for service-based images or to provide an interactive shell. There should only be one CMD instruction in the Dockerfile. Review Dockerfile reference for CMD instruction for more details."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP29F91BA8",
      "title": "Rebuild your images often",
      "severity": "MEDIUM",
      "message": "Checking for frequent rebuilds or the use of --no-cache options requires understanding of the build context and potentially external CI/CD configurations, which cannot be determined from a single line or without understanding the Dockerfile's build history.",
      "suggestion": "Ensure to rebuild your Docker images frequently to incorporate updated dependencies and base images. Consider using the --no-cache option during builds to avoid using outdated layers. Additionally, pin your base images to specific versions to ensure consistency and reliability in your builds."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP2AA02452",
      "title": "Create ephemeral containers",
      "severity": "HIGH",
      "message": "Evaluating the ephemerality of a container requires understanding the application architecture, how data is managed, and if state is externalized. This cannot be determined by simple line-by-line analysis or without context of how the container is used in production.",
      "suggestion": "Ensure that your container does not store state internally and can be easily replaced by rebuilding the image. Externalize state (e.g., databases, queues) and configuration (e.g., environment variables, config files outside the container)."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP32CAE590",
      "title": "Choose the right base image",
      "severity": "HIGH",
      "message": "Due to the linter's limitations, it cannot verify if the chosen base image is minimal for the application's requirements, nor can it confirm the image's source is trusted. This requires manual review of the base image against the project's needs and security best practices.",
      "suggestion": "Ensure your Dockerfile's FROM instruction specifies a minimal, trusted base image appropriate for your application's needs. Avoid using the 'latest' tag where possible, and consider pinning the image to a specific digest for more reliable and secure builds. Review your base image choice manually to confirm it's minimal and from a trusted source."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP496813AA",
      "title": "Sort multi-line arguments",
      "severity": "LOW",
      "message": "Due to the linter's inability to parse Dockerfile structure or understand context across multiple lines, checking for sorted multi-line arguments in instructions like RUN requires manual review. This includes verifying alphabetical order and the presence of a space before backslashes in multi-line commands.",
      "suggestion": "Ensure that multi-line arguments, especially in RUN instructions for installing packages, are sorted alphanumerically. This practice aids in maintenance and readability. Additionally, include a space before backslashes for line continuation."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP4C08BC02",
      "title": "ONBUILD",
      "severity": "MEDIUM",
      "message": "Requires manual review to ensure ONBUILD instructions are used appropriately for the intended child image builds and to verify that images built with ONBUILD have a separate tag to mitigate potential build context issues.",
      "suggestion": "Avoid using ADD or COPY within ONBUILD instructions due to potential build context issues. Consider adding a separate tag for images built with ONBUILD to allow Dockerfile authors to make informed choices."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP4F995E92",
      "title": "ADD or COPY",
      "severity": "MEDIUM",
      "message": "Due to the linter's limitations, it cannot verify if COPY is used appropriately for copying files from one stage to another in a multi-stage build or if bind mounts are used instead of COPY for temporary file inclusion during build. Manual review is required to ensure best practices for file copying are followed.",
      "suggestion": "Prefer using COPY for copying local files and directories into the container. Use ADD only when you need to fetch files from remote URLs or automatically extract tar files."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP4FB971F0",
      "title": "EXPOSE",
      "severity": "INFO",
      "message": "Manual review is required to ensure the EXPOSE instruction uses the appropriate port for the application if it's not one of the common ports (80, 443, 27017).",
      "suggestion": "Ensure the EXPOSE instruction specifies the common, traditional port for your application. If your application uses a port different from common ones (80, 443, 27017), verify it's the correct port for your application's needs."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP5FE7DA5A",
      "title": "Create reusable stages",
      "severity": "MEDIUM",
      "message": "Due to the linter's limitations, it cannot verify if a common stage is effectively used by other stages or if there's significant repetition across stages. This requires manual review to ensure stages are reused efficiently and DRY principles are applied.",
      "suggestion": "Identify common components or setup procedures across multiple Docker images. Create a base stage with these commonalities and use this as a foundation for other images by referencing it in subsequent FROM instructions as stages."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP64B8A7E2",
      "title": "LABEL",
      "severity": "INFO",
      "message": "Due to linter limitations, manual review is required to ensure that strings with spaces are properly quoted or escaped, and inner quote characters (\\\") are also escaped as needed.",
      "suggestion": "Ensure each LABEL instruction uses a properly formatted key-value pair. Strings with spaces should be quoted or escaped, and inner quote characters (\\\") must be escaped. Consider combining labels into a single instruction if it improves readability and maintainability of your Dockerfile."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Manual review required to verify if USER instruction switches to a non-root user and not frequently switched back and forth.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP844BB562",
      "title": "Use multi-stage builds",
      "severity": "HIGH",
      "message": "Due to the linter's limitations, it cannot verify if the multi-stage builds are properly utilized to separate the build stage from the final output stage, nor can it check if build steps are executed in parallel. This requires manual review.",
      "suggestion": "Split your Dockerfile into multiple stages using multiple FROM instructions. Ensure that each stage is focused on a specific part of the build process, and use COPY --from= to transfer only the necessary artifacts between stages."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP8E7F00CF",
      "title": "FROM",
      "severity": "HIGH",
      "message": "Due to linter limitations, manual review is required to ensure the base image is an official, up-to-date, and minimal image as recommended by Docker, beyond just using Alpine.",
      "suggestion": "Prefer using the Alpine image for its small size and security benefits. Avoid using the 'latest' tag to ensure your builds are predictable and reproducible. For non-Alpine images, manually verify they are official and minimal for your needs."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP9F076259",
      "title": "Leverage build cache",
      "severity": "HIGH",
      "message": "Due to the linter's inability to understand Dockerfile structure, instruction order, or context across multiple lines, assessing the effective use of the build cache requires manual review. This includes evaluating if instructions that change often are placed towards the end of the Dockerfile to maximize cache reuse for earlier layers.",
      "suggestion": "Review Dockerfile to ensure instructions that change less frequently are placed at the beginning, and those that change more frequently towards the end, to leverage Docker's build cache effectively. For instance, placing `COPY . /app` before installing dependencies via `RUN pip install -r requirements.txt` can invalidate the cache unnecessarily for subsequent builds when source code changes."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Requires manual review to ensure complex RUN instructions are properly split into multiple lines for readability, and to verify the use of here documents for running multiple commands without chaining them with &&.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Requires manual review to ensure that version pinning is used for package installation to avoid unexpected changes.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Requires manual review to ensure that the apt cache is cleaned up by removing /var/lib/apt/lists to reduce the image size.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Requires manual review to verify that set -o pipefail is used for RUN commands that pipe the output of one command into another to ensure the build fails if any command in the pipe fails.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: File '.dockerignore'",
      "rule_id": "BPAEDF7F2F",
      "title": "Exclude with .dockerignore",
      "severity": "HIGH",
      "message": "File '.dockerignore' check failed: File does not exist (required but not found). Check if a .dockerignore file exists in the same directory as the Dockerfile.",
      "suggestion": "Create a .dockerignore file in the same directory as your Dockerfile to exclude files not relevant to the build. Use patterns similar to .gitignore to specify which files or directories to ignore."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BPAF7FDF55",
      "title": "Don't install unnecessary packages",
      "severity": "MEDIUM",
      "message": "Determining the necessity of a package requires understanding the application's architecture and the purpose of the image. This cannot be accurately automated without context.",
      "suggestion": "Review the list of packages being installed and remove any that are not necessary for running the application or service the container is intended for."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BPD5DA0774",
      "title": "Build and test your images in CI",
      "severity": "HIGH",
      "message": "Automated building and testing of Docker images in CI/CD cannot be verified through Dockerfile analysis alone. This process involves external CI/CD configuration files and workflows, such as GitHub Actions, which are beyond the scope of a Dockerfile linter.",
      "suggestion": "Ensure your project's CI/CD pipeline is configured to automatically build and test the Docker image upon each commit or pull request. Refer to your CI/CD tool's documentation for guidance on setting up automated Docker image builds and tests."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BPFAEF57A2",
      "title": "ENTRYPOINT",
      "severity": "HIGH",
      "message": "Due to linter limitations, manual review is required to ensure ENTRYPOINT is used correctly as the main command and CMD is used for default flags, and to verify if a helper script is used with ENTRYPOINT for complex setups.",
      "suggestion": "Ensure ENTRYPOINT is set to the image's main command, allowing the image to run as that command. Use CMD to specify default flags. Consider using a helper script with ENTRYPOINT for complex setups."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BPFE9F359F",
      "title": "Decouple applications",
      "severity": "HIGH",
      "message": "Due to the linter's limitations in understanding Dockerfile structure, context across multiple instructions, and the inability to verify external information such as the purpose of each container, this rule requires manual review to ensure that each container is focused on a single concern and that applications are properly decoupled into multiple containers where appropriate.",
      "suggestion": "Review your Docker setup to ensure that each container is dedicated to a single concern. Consider splitting complex applications into multiple containers to improve scalability and maintainability. Use Docker container networks for inter-container communication if necessary."
    },
    {
      "line_number": 1,
      "line_content": "FROM ubuntu:latest",
      "rule_id": "BP32CAE590",
      "title": "Choose the right base image",
      "severity": "HIGH",
      "message": "Required pattern not found: Check if the FROM instruction specifies an image not using the 'latest' tag.",
      "suggestion": "Ensure your Dockerfile's FROM instruction specifies a minimal, trusted base image appropriate for your application's needs. Avoid using the 'latest' tag where possible, and consider pinning the image to a specific digest for more reliable and secure builds. Review your base image choice manually to confirm it's minimal and from a trusted source."
    },
    {
      "line_number": 1,
      "line_content": "FROM ubuntu:latest",
      "rule_id": "BP32CAE590",
      "title": "Choose the right base image",
      "severity": "HIGH",
      "message": "Required pattern not found: Check if the FROM instruction specifies an image pinned by digest.",
      "suggestion": "Ensure your Dockerfile's FROM instruction specifies a minimal, trusted base image appropriate for your application's needs. Avoid using the 'latest' tag where possible, and consider pinning the image to a specific digest for more reliable and secure builds. Review your base image choice manually to confirm it's minimal and from a trusted source."
    },
    {
      "line_number": 1,
      "line_content": "FROM ubuntu:latest",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 1,
      "line_content": "FROM ubuntu:latest",
      "rule_id": "BP8E7F00CF",
      "title": "FROM",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if the FROM instruction specifies an Alpine image, potentially with a tag.",
      "suggestion": "Prefer using the Alpine image for its small size and security benefits. Avoid using the 'latest' tag to ensure your builds are predictable and reproducible. For non-Alpine images, manually verify they are official and minimal for your needs."
    },
    {
      "line_number": 1,
      "line_content": "FROM ubuntu:latest",
      "rule_id": "BP8E7F00CF",
      "title": "FROM",
      "severity": "HIGH",
      "message": "Disallowed pattern found: Using 'latest' tag for base image.",
      "suggestion": "Prefer using the Alpine image for its small size and security benefits. Avoid using the 'latest' tag to ensure your builds are predictable and reproducible. For non-Alpine images, manually verify they are official and minimal for your needs."
    },
    {
      "line_number": 1,
      "line_content": "FROM ubuntu:latest",
      "rule_id": "BPB8CA77FB",
      "title": "Pin base image versions",
      "severity": "HIGH",
      "message": "Required pattern not found: Check if the FROM instruction specifies an image pinned by digest.",
      "suggestion": "Ensure that the base image in your Dockerfile is pinned to a specific digest to guarantee the use of the same image version across builds. For example, use FROM alpine@sha256:12345... instead of using a tag like alpine:latest or alpine:3.12."
    },
    {
      "line_number": 2,
      "line_content": "FROM python:3.9 AS builder",
      "rule_id": "BP32CAE590",
      "title": "Choose the right base image",
      "severity": "HIGH",
      "message": "Required pattern not found: Check if the FROM instruction specifies an image pinned by digest.",
      "suggestion": "Ensure your Dockerfile's FROM instruction specifies a minimal, trusted base image appropriate for your application's needs. Avoid using the 'latest' tag where possible, and consider pinning the image to a specific digest for more reliable and secure builds. Review your base image choice manually to confirm it's minimal and from a trusted source."
    },
    {
      "line_number": 2,
      "line_content": "FROM python:3.9 AS builder",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 2,
      "line_content": "FROM python:3.9 AS builder",
      "rule_id": "BP8E7F00CF",
      "title": "FROM",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if the FROM instruction specifies an Alpine image, potentially with a tag.",
      "suggestion": "Prefer using the Alpine image for its small size and security benefits. Avoid using the 'latest' tag to ensure your builds are predictable and reproducible. For non-Alpine images, manually verify they are official and minimal for your needs."
    },
    {
      "line_number": 2,
      "line_content": "FROM python:3.9 AS builder",
      "rule_id": "BPB8CA77FB",
      "title": "Pin base image versions",
      "severity": "HIGH",
      "message": "Required pattern not found: Check if the FROM instruction specifies an image pinned by digest.",
      "suggestion": "Ensure that the base image in your Dockerfile is pinned to a specific digest to guarantee the use of the same image version across builds. For example, use FROM alpine@sha256:12345... instead of using a tag like alpine:latest or alpine:3.12."
    },
    {
      "line_number": 4,
      "line_content": "RUN apt-get update",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Disallowed keyword(s) ('sudo') found. Check for the presence of 'sudo' which should be avoided.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 4,
      "line_content": "RUN apt-get update",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 4,
      "line_content": "RUN apt-get update",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 4,
      "line_content": "RUN apt-get update",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install are combined in the same RUN statement.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 4,
      "line_content": "RUN apt-get update",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Detects if apt-get install includes the --no-install-recommends flag.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 5,
      "line_content": "RUN apt-get install -y python3",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Disallowed keyword(s) ('sudo') found. Check for the presence of 'sudo' which should be avoided.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 5,
      "line_content": "RUN apt-get install -y python3",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 5,
      "line_content": "RUN apt-get install -y python3",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 5,
      "line_content": "RUN apt-get install -y python3",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install are combined in the same RUN statement.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 5,
      "line_content": "RUN apt-get install -y python3",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Detects if apt-get install includes the --no-install-recommends flag.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 6,
      "line_content": "RUN apt-get install -y vim nano curl wget",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Disallowed keyword(s) ('sudo') found. Check for the presence of 'sudo' which should be avoided.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 6,
      "line_content": "RUN apt-get install -y vim nano curl wget",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 6,
      "line_content": "RUN apt-get install -y vim nano curl wget",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 6,
      "line_content": "RUN apt-get install -y vim nano curl wget",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install are combined in the same RUN statement.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 6,
      "line_content": "RUN apt-get install -y vim nano curl wget",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Detects if apt-get install includes the --no-install-recommends flag.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 7,
      "line_content": "RUN apt-get install -y nginx",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Disallowed keyword(s) ('sudo') found. Check for the presence of 'sudo' which should be avoided.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 7,
      "line_content": "RUN apt-get install -y nginx",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 7,
      "line_content": "RUN apt-get install -y nginx",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 7,
      "line_content": "RUN apt-get install -y nginx",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install are combined in the same RUN statement.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 7,
      "line_content": "RUN apt-get install -y nginx",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Detects if apt-get install includes the --no-install-recommends flag.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 9,
      "line_content": "ADD . /app",
      "rule_id": "BP4F995E92",
      "title": "ADD or COPY",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if ADD is used for adding tar files, which is an appropriate use case.",
      "suggestion": "Prefer using COPY for copying local files and directories into the container. Use ADD only when you need to fetch files from remote URLs or automatically extract tar files."
    },
    {
      "line_number": 9,
      "line_content": "ADD . /app",
      "rule_id": "BP4F995E92",
      "title": "ADD or COPY",
      "severity": "MEDIUM",
      "message": "Disallowed pattern found: Detects ADD being used instead of COPY for local file copying, which should be avoided unless using ADD's unique features.",
      "suggestion": "Prefer using COPY for copying local files and directories into the container. Use ADD only when you need to fetch files from remote URLs or automatically extract tar files."
    },
    {
      "line_number": 9,
      "line_content": "ADD . /app",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 10,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Disallowed keyword(s) ('sudo') found. Check for the presence of 'sudo' which should be avoided.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 10,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 10,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 10,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install are combined in the same RUN statement.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 10,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Detects if apt-get install includes the --no-install-recommends flag.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 12,
      "line_content": "RUN apt-get install -y postgresql",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Disallowed keyword(s) ('sudo') found. Check for the presence of 'sudo' which should be avoided.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 12,
      "line_content": "RUN apt-get install -y postgresql",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 12,
      "line_content": "RUN apt-get install -y postgresql",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 12,
      "line_content": "RUN apt-get install -y postgresql",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install are combined in the same RUN statement.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 12,
      "line_content": "RUN apt-get install -y postgresql",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Detects if apt-get install includes the --no-install-recommends flag.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 14,
      "line_content": "RUN mkdir -p /var/log/myapp",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Disallowed keyword(s) ('sudo') found. Check for the presence of 'sudo' which should be avoided.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 14,
      "line_content": "RUN mkdir -p /var/log/myapp",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 14,
      "line_content": "RUN mkdir -p /var/log/myapp",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 14,
      "line_content": "RUN mkdir -p /var/log/myapp",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install are combined in the same RUN statement.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 14,
      "line_content": "RUN mkdir -p /var/log/myapp",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Detects if apt-get install includes the --no-install-recommends flag.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 15,
      "line_content": "RUN echo \"log data\" > /var/log/app.log",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Disallowed keyword(s) ('sudo') found. Check for the presence of 'sudo' which should be avoided.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 15,
      "line_content": "RUN echo \"log data\" > /var/log/app.log",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 15,
      "line_content": "RUN echo \"log data\" > /var/log/app.log",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 15,
      "line_content": "RUN echo \"log data\" > /var/log/app.log",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install are combined in the same RUN statement.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 15,
      "line_content": "RUN echo \"log data\" > /var/log/app.log",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Detects if apt-get install includes the --no-install-recommends flag.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 17,
      "line_content": "WORKDIR app",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 17,
      "line_content": "WORKDIR app",
      "rule_id": "BP9166D7E9",
      "title": "WORKDIR",
      "severity": "HIGH",
      "message": "Disallowed pattern found: Detects WORKDIR using a relative path.",
      "suggestion": "Use absolute paths when setting the WORKDIR instruction. Replace any 'RUN cd ... && do-something' patterns with WORKDIR followed by the desired command without 'cd'."
    },
    {
      "line_number": 19,
      "line_content": "COPY .git /app/.git",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 20,
      "line_content": "COPY README.md /app/",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 21,
      "line_content": "COPY node_modules /app/node_modules",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 23,
      "line_content": "CMD [\"sh\", \"-c\", \"nginx & python3 app.py\"]",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 25,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Disallowed keyword(s) ('sudo') found. Check for the presence of 'sudo' which should be avoided.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 25,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 25,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 25,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install are combined in the same RUN statement.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 25,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Detects if apt-get install includes the --no-install-recommends flag.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 27,
      "line_content": "EXPOSE 22",
      "rule_id": "BP4FB971F0",
      "title": "EXPOSE",
      "severity": "INFO",
      "message": "Required pattern not found: Checks if EXPOSE uses common ports (80, 443 for web servers, 27017 for MongoDB).",
      "suggestion": "Ensure the EXPOSE instruction specifies the common, traditional port for your application. If your application uses a port different from common ones (80, 443, 27017), verify it's the correct port for your application's needs."
    },
    {
      "line_number": 27,
      "line_content": "EXPOSE 22",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 28,
      "line_content": "EXPOSE 80",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 29,
      "line_content": "EXPOSE 3389",
      "rule_id": "BP4FB971F0",
      "title": "EXPOSE",
      "severity": "INFO",
      "message": "Required pattern not found: Checks if EXPOSE uses common ports (80, 443 for web servers, 27017 for MongoDB).",
      "suggestion": "Ensure the EXPOSE instruction specifies the common, traditional port for your application. If your application uses a port different from common ones (80, 443, 27017), verify it's the correct port for your application's needs."
    },
    {
      "line_number": 29,
      "line_content": "EXPOSE 3389",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 31,
      "line_content": "ENV DEBUG=",
      "rule_id": "BP086BFB42",
      "title": "ENV",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if ENV is used to set PATH, making software easier to run.",
      "suggestion": "Use ENV to set the PATH environment variable and other necessary environment variables for your application. Consider consolidating ENV instructions to reduce layers when possible. For version numbers, use ENV to make updates easier. To unset an environment variable, use a RUN command with shell commands to set, use, and unset the variable in a single layer for better security and efficiency."
    },
    {
      "line_number": 31,
      "line_content": "ENV DEBUG=",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 32,
      "line_content": "ENV APP_VERSION",
      "rule_id": "BP086BFB42",
      "title": "ENV",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if ENV is used to set PATH, making software easier to run.",
      "suggestion": "Use ENV to set the PATH environment variable and other necessary environment variables for your application. Consider consolidating ENV instructions to reduce layers when possible. For version numbers, use ENV to make updates easier. To unset an environment variable, use a RUN command with shell commands to set, use, and unset the variable in a single layer for better security and efficiency."
    },
    {
      "line_number": 32,
      "line_content": "ENV APP_VERSION",
      "rule_id": "BP086BFB42",
      "title": "ENV",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if ENV is used to set environment variables.",
      "suggestion": "Use ENV to set the PATH environment variable and other necessary environment variables for your application. Consider consolidating ENV instructions to reduce layers when possible. For version numbers, use ENV to make updates easier. To unset an environment variable, use a RUN command with shell commands to set, use, and unset the variable in a single layer for better security and efficiency."
    },
    {
      "line_number": 32,
      "line_content": "ENV APP_VERSION",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 34,
      "line_content": "RUN cd /app && \\",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Disallowed keyword(s) ('sudo') found. Check for the presence of 'sudo' which should be avoided.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 34,
      "line_content": "RUN cd /app && \\",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    },
    {
      "line_number": 34,
      "line_content": "RUN cd /app && \\",
      "rule_id": "BP9166D7E9",
      "title": "WORKDIR",
      "severity": "HIGH",
      "message": "Disallowed pattern found: Detects usage of 'RUN cd ... && do-something' which should be replaced with WORKDIR.",
      "suggestion": "Use absolute paths when setting the WORKDIR instruction. Replace any 'RUN cd ... && do-something' patterns with WORKDIR followed by the desired command without 'cd'."
    },
    {
      "line_number": 34,
      "line_content": "RUN cd /app && \\",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install are combined in the same RUN statement.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 34,
      "line_content": "RUN cd /app && \\",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Detects if apt-get install includes the --no-install-recommends flag.",
      "suggestion": "Ensure complex RUN instructions are split across multiple lines using backslashes. Combine apt-get update with apt-get install in the same RUN statement and use --no-install-recommends with apt-get install. Consider manual review for complex scenarios not covered by automated checks."
    },
    {
      "line_number": 35,
      "line_content": "    mkdir temp ",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Ensure there is at least one USER instruction to switch to a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' within your Dockerfile. If necessary, consider alternatives like 'gosu' for privilege escalation. Minimize the use of switching users to reduce complexity."
    }
  ]
}