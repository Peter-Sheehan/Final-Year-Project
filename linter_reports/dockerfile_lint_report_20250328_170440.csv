Severity,Line,Rule,Description,Suggestion,Line Content
HIGH,1,Avoid using latest tag,Using 'latest' can lead to non-reproducible builds.,"Use a specific version tag (e.g., 'FROM ubuntu:22.04').",FROM ubuntu:latest
HIGH,2,Use multi-stage builds,Multi-stage builds reduce the final image size and optimize the build process by separating build and runtime stages.,Consider using multi-stage builds to reduce final image size. Add 'AS builder' to your build stage.,FROM python:3.9 AS builder
HIGH,2,Create reusable stages,Reusing stages for common dependencies improves efficiency and reduces redundant builds.,Use named build stages to enhance modularity and reusability.,FROM python:3.9 AS builder
MEDIUM,4,Avoid apt-get update alone,Running apt-get update in a separate layer without install can lead to stale caches.,Combine 'apt-get update' and 'apt-get install' in a single RUN instruction.,RUN apt-get update
HIGH,5,Pin package versions,Pinning package versions ensures that builds remain consistent.,Specify exact package versions instead of relying on the latest available version.,RUN apt-get install -y python3
MEDIUM,5,Use apt-get install --no-install-recommends,Minimize image size by avoiding installing recommended extra packages.,Add '--no-install-recommends' to apt-get install to reduce unnecessary packages.,RUN apt-get install -y python3
MEDIUM,5,Clean up apt cache,Removing /var/lib/apt/lists prevents caching large package indexes in layers.,"After apt-get install, run 'rm -rf /var/lib/apt/lists/*' in the same RUN command.",RUN apt-get install -y python3
HIGH,6,Pin package versions,Pinning package versions ensures that builds remain consistent.,Specify exact package versions instead of relying on the latest available version.,RUN apt-get install -y vim nano curl wget
MEDIUM,6,Use apt-get install --no-install-recommends,Minimize image size by avoiding installing recommended extra packages.,Add '--no-install-recommends' to apt-get install to reduce unnecessary packages.,RUN apt-get install -y vim nano curl wget
MEDIUM,6,Clean up apt cache,Removing /var/lib/apt/lists prevents caching large package indexes in layers.,"After apt-get install, run 'rm -rf /var/lib/apt/lists/*' in the same RUN command.",RUN apt-get install -y vim nano curl wget
MEDIUM,6,Avoid installing unnecessary packages,Unnecessary packages (like text editors) bloat the image and can introduce security risks.,Remove unneeded utilities or move them to separate debug images. Keep images minimal.,RUN apt-get install -y vim nano curl wget
HIGH,7,Pin package versions,Pinning package versions ensures that builds remain consistent.,Specify exact package versions instead of relying on the latest available version.,RUN apt-get install -y nginx
MEDIUM,7,Use apt-get install --no-install-recommends,Minimize image size by avoiding installing recommended extra packages.,Add '--no-install-recommends' to apt-get install to reduce unnecessary packages.,RUN apt-get install -y nginx
MEDIUM,7,Clean up apt cache,Removing /var/lib/apt/lists prevents caching large package indexes in layers.,"After apt-get install, run 'rm -rf /var/lib/apt/lists/*' in the same RUN command.",RUN apt-get install -y nginx
MEDIUM,9,Use COPY instead of ADD,"'ADD' has extra functionality like auto-extracting tar files, which is often unnecessary and can cause unexpected behavior.",Use 'COPY' instead of 'ADD' unless remote file download or auto-extraction is required.,ADD . /app
HIGH,10,Pin package versions,Pinning package versions ensures that builds remain consistent.,Specify exact package versions instead of relying on the latest available version.,RUN apt-get install -y redis-server
MEDIUM,10,Use apt-get install --no-install-recommends,Minimize image size by avoiding installing recommended extra packages.,Add '--no-install-recommends' to apt-get install to reduce unnecessary packages.,RUN apt-get install -y redis-server
MEDIUM,10,Clean up apt cache,Removing /var/lib/apt/lists prevents caching large package indexes in layers.,"After apt-get install, run 'rm -rf /var/lib/apt/lists/*' in the same RUN command.",RUN apt-get install -y redis-server
HIGH,12,Pin package versions,Pinning package versions ensures that builds remain consistent.,Specify exact package versions instead of relying on the latest available version.,RUN apt-get install -y postgresql
MEDIUM,12,Use apt-get install --no-install-recommends,Minimize image size by avoiding installing recommended extra packages.,Add '--no-install-recommends' to apt-get install to reduce unnecessary packages.,RUN apt-get install -y postgresql
MEDIUM,12,Clean up apt cache,Removing /var/lib/apt/lists prevents caching large package indexes in layers.,"After apt-get install, run 'rm -rf /var/lib/apt/lists/*' in the same RUN command.",RUN apt-get install -y postgresql
MEDIUM,17,Use absolute path in WORKDIR,Relative WORKDIR paths can cause unexpected behavior and reduce clarity.,"Use absolute paths in WORKDIR (e.g., WORKDIR /app).",WORKDIR app
LOW,19,Use .dockerignore to exclude unnecessary files,Excluding unnecessary files from the build context improves build speed and reduces image size.,Use a .dockerignore file to exclude unnecessary files from the build context.,COPY .git /app/.git
LOW,20,Use .dockerignore to exclude unnecessary files,Excluding unnecessary files from the build context improves build speed and reduces image size.,Use a .dockerignore file to exclude unnecessary files from the build context.,COPY README.md /app/
LOW,21,Use .dockerignore to exclude unnecessary files,Excluding unnecessary files from the build context improves build speed and reduces image size.,Use a .dockerignore file to exclude unnecessary files from the build context.,COPY node_modules /app/node_modules
HIGH,25,Pin package versions,Pinning package versions ensures that builds remain consistent.,Specify exact package versions instead of relying on the latest available version.,RUN apt-get install -y redis-server
MEDIUM,25,Use apt-get install --no-install-recommends,Minimize image size by avoiding installing recommended extra packages.,Add '--no-install-recommends' to apt-get install to reduce unnecessary packages.,RUN apt-get install -y redis-server
MEDIUM,25,Clean up apt cache,Removing /var/lib/apt/lists prevents caching large package indexes in layers.,"After apt-get install, run 'rm -rf /var/lib/apt/lists/*' in the same RUN command.",RUN apt-get install -y redis-server
MEDIUM,31,Ensure ENV is not empty,Empty ENV variables add confusion and may be unintentional.,"Provide a value for ENV, or remove it if unnecessary.",ENV DEBUG=
MEDIUM,32,Ensure ENV is not empty,Empty ENV variables add confusion and may be unintentional.,"Provide a value for ENV, or remove it if unnecessary.",ENV APP_VERSION
CRITICAL,34,Use USER Instruction and specify a non root user,No USER instruction found in Dockerfile. Running containers as root is a security risk.,"Add a USER instruction with a non-root user (e.g., 'USER myapp').",No USER instruction found in Dockerfile
MEDIUM,3,Combine multiple RUN commands,Combining RUN commands reduces the number of layers and optimizes caching.,Combine multiple RUN commands using '&&' to reduce image layers.,
MEDIUM,6,Combine multiple RUN commands,Combining RUN commands reduces the number of layers and optimizes caching.,Combine multiple RUN commands using '&&' to reduce image layers.,RUN apt-get install -y vim nano curl wget
MEDIUM,13,Combine multiple RUN commands,Combining RUN commands reduces the number of layers and optimizes caching.,Combine multiple RUN commands using '&&' to reduce image layers.,
