{
  "dockerfile": "Dockerfile2",
  "total_issues": 91,
  "issues": [
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP086BFB42",
      "title": "ENV",
      "severity": "MEDIUM",
      "message": "Due to linter limitations, manual review is required to ensure ENV instructions are used effectively for setting version numbers, and that any ENV variable set is properly unset in the same layer if needed, to avoid leaving sensitive information in intermediate layers.",
      "suggestion": "Use ENV to set the PATH environment variable and other necessary environment variables for your application. Ensure sensitive environment variables are unset in the same layer they are used to avoid leaking information in intermediate layers. Consider using a single ENV instruction for setting multiple variables to reduce layers."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP29F91BA8",
      "title": "Rebuild your images often",
      "severity": "MEDIUM",
      "message": "Due to the linter's limitations, it cannot verify if images are being rebuilt often or if the --no-cache option is used during builds. This requires understanding of the build context, frequency, and external tooling or CI/CD processes.",
      "suggestion": "Ensure to rebuild Docker images frequently to incorporate updated dependencies and security patches. Avoid using the cache during builds by specifying the --no-cache option in your build command to ensure all layers are freshly pulled and built. Consider pinning your base images to specific versions to ensure consistency and reliability in your builds."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP2AA02452",
      "title": "Create ephemeral containers",
      "severity": "HIGH",
      "message": "Evaluating the ephemerality of a container requires understanding the application architecture, including how data is managed and whether state is stored externally. This cannot be determined from a single Dockerfile instruction or without context of the application's overall design.",
      "suggestion": "Ensure your container does not store state internally and can be easily replaced by rebuilding the image. Use volumes for persistent data and environment variables for configuration. Review the Twelve-factor App methodology for guidance on designing stateless applications."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP32CAE590",
      "title": "Choose the right base image",
      "severity": "HIGH",
      "message": "Requires manual review to ensure the base image is from a trusted source, is minimal for the application's needs, and does not include unnecessary build tools for production.",
      "suggestion": "Avoid using the ':latest' tag for base images to ensure reproducibility. Consider using a minimal base image like 'alpine' for smaller, more secure deployments. Ensure the base image is from a trusted source. For production, use a base image without unnecessary build tools."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP496813AA",
      "title": "Sort multi-line arguments",
      "severity": "LOW",
      "message": "Due to the linter's inability to understand context across multiple lines or instructions, verifying the alphabetical sorting of multi-line arguments in instructions like RUN requires manual review.",
      "suggestion": "Ensure that multi-line arguments, especially package lists in RUN instructions, are sorted alphanumerically. This facilitates easier maintenance and review. Additionally, include a space before backslashes for better readability."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP4F995E92",
      "title": "ADD or COPY",
      "severity": "INFO",
      "message": "Due to the linter's limitations, it cannot verify if COPY is used instead of ADD when simply copying files from the build context without needing the additional features of ADD. This requires manual review.",
      "suggestion": "Prefer using COPY for copying local files in the build context. Use ADD for remote URLs and auto-extracting tar files. Review the use of COPY and ADD to ensure they are used appropriately according to their functionalities."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP5FE7DA5A",
      "title": "Create reusable stages",
      "severity": "MEDIUM",
      "message": "Manual review is required to ensure that reusable stages are created for components shared across multiple images, which cannot be automatically detected by a simple line-by-line linter.",
      "suggestion": "Review your Dockerfile to identify common components across multiple images. Create a base stage with these components and use it as a foundation for other images to improve efficiency and maintainability."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Manual review required to ensure USER is not switched back and forth frequently, which can increase layers and complexity.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BP9F076259",
      "title": "Leverage build cache",
      "severity": "HIGH",
      "message": "Due to the linter's inability to understand instruction order or context across multiple lines, evaluating the effective use of the Docker build cache requires manual review. This includes assessing if instructions that change often are placed towards the end of the Dockerfile to maximize cache utilization.",
      "suggestion": "Review Dockerfile to ensure instructions that change frequently are placed towards the end, and static instructions are at the beginning. This maximizes the use of Docker's build cache, speeding up build times."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Due to the linter's limitations, it cannot verify if RUN instructions that use pipe (|) operators are preceded by 'set -o pipefail &&' to ensure the build fails on any command error. This requires manual review.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: File '.dockerignore'",
      "rule_id": "BPAEDF7F2F",
      "title": "Exclude with .dockerignore",
      "severity": "HIGH",
      "message": "Required file '.dockerignore' not found. Check if a .dockerignore file exists in the same directory as the Dockerfile.",
      "suggestion": "Create a .dockerignore file in the same directory as your Dockerfile to exclude files not relevant to the build. Use patterns similar to .gitignore to specify which files or directories to ignore."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BPD5DA0774",
      "title": "Build and test your images in CI",
      "severity": "HIGH",
      "message": "This check requires verifying if CI/CD pipelines like GitHub Actions are configured to build and test Docker images upon code commits or pull requests. Such verification goes beyond the Dockerfile content and involves external CI/CD configuration, which cannot be assessed by a simple line-by-line Dockerfile linter.",
      "suggestion": "Ensure your project's CI/CD pipeline (e.g., GitHub Actions, GitLab CI/CD) is configured to automatically build and test your Docker images upon every commit or pull request. This may involve creating or updating a CI/CD configuration file in your repository."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: VOLUME Count",
      "rule_id": "BPDE4F1AAB",
      "title": "VOLUME",
      "severity": "MEDIUM",
      "message": "Instruction 'VOLUME' count is 0, which does not meet the requirement (expected: greater than 0). Checks if the VOLUME instruction is used at least once.",
      "suggestion": "Ensure at least one VOLUME instruction is used to expose any necessary files, folders, or data storage areas created by your Docker container."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BPFAEF57A2",
      "title": "ENTRYPOINT",
      "severity": "HIGH",
      "message": "Review if ENTRYPOINT is used in combination with CMD to provide default flags.",
      "suggestion": "Ensure your Dockerfile contains exactly one ENTRYPOINT instruction, used to set the main command of the image. Combine ENTRYPOINT with CMD to provide default flags. Consider using a helper script with ENTRYPOINT for complex startup sequences, ensuring it uses exec to handle signals correctly."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BPFAEF57A2",
      "title": "ENTRYPOINT",
      "severity": "HIGH",
      "message": "Ensure ENTRYPOINT is used to set the image's main command, allowing the image to be run as if it was that command.",
      "suggestion": "Ensure your Dockerfile contains exactly one ENTRYPOINT instruction, used to set the main command of the image. Combine ENTRYPOINT with CMD to provide default flags. Consider using a helper script with ENTRYPOINT for complex startup sequences, ensuring it uses exec to handle signals correctly."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BPFAEF57A2",
      "title": "ENTRYPOINT",
      "severity": "HIGH",
      "message": "Verify if ENTRYPOINT uses a helper script for complex startup sequences, and that it uses exec to ensure signals are properly handled.",
      "suggestion": "Ensure your Dockerfile contains exactly one ENTRYPOINT instruction, used to set the main command of the image. Combine ENTRYPOINT with CMD to provide default flags. Consider using a helper script with ENTRYPOINT for complex startup sequences, ensuring it uses exec to handle signals correctly."
    },
    {
      "line_number": 1,
      "line_content": "Global Check: Manual Review",
      "rule_id": "BPFE9F359F",
      "title": "Decouple applications",
      "severity": "HIGH",
      "message": "Due to the linter's limitations in understanding Dockerfile structure, application architecture, and the context across multiple lines or instructions, this rule requires manual review to ensure that each container is focused on a single concern, and applications are properly decoupled into multiple containers where necessary.",
      "suggestion": "Review your Dockerfile and application architecture to ensure that each container is dedicated to a single concern. If your application consists of multiple components (e.g., web server, database, cache), consider splitting these into separate containers to facilitate scaling and improve modularity. Use Docker container networks for inter-container communication if necessary."
    },
    {
      "line_number": 1,
      "line_content": "FROM ubuntu:latest",
      "rule_id": "BP32CAE590",
      "title": "Choose the right base image",
      "severity": "HIGH",
      "message": "Disallowed pattern found: Using 'latest' tag for base image.",
      "suggestion": "Avoid using the ':latest' tag for base images to ensure reproducibility. Consider using a minimal base image like 'alpine' for smaller, more secure deployments. Ensure the base image is from a trusted source. For production, use a base image without unnecessary build tools."
    },
    {
      "line_number": 1,
      "line_content": "FROM ubuntu:latest",
      "rule_id": "BP32CAE590",
      "title": "Choose the right base image",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if the FROM instruction specifies 'scratch' indicating a minimal base.",
      "suggestion": "Avoid using the ':latest' tag for base images to ensure reproducibility. Consider using a minimal base image like 'alpine' for smaller, more secure deployments. Ensure the base image is from a trusted source. For production, use a base image without unnecessary build tools."
    },
    {
      "line_number": 1,
      "line_content": "FROM ubuntu:latest",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 1,
      "line_content": "FROM ubuntu:latest",
      "rule_id": "BP8E7F00CF",
      "title": "FROM",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if the FROM instruction specifies an Alpine image, potentially with a tag.",
      "suggestion": "Use an official Alpine image as the base for your Dockerfile to minimize size and ensure security. Avoid using the 'latest' tag to ensure predictable builds."
    },
    {
      "line_number": 1,
      "line_content": "FROM ubuntu:latest",
      "rule_id": "BP8E7F00CF",
      "title": "FROM",
      "severity": "HIGH",
      "message": "Disallowed pattern found: Using 'latest' tag for base image.",
      "suggestion": "Use an official Alpine image as the base for your Dockerfile to minimize size and ensure security. Avoid using the 'latest' tag to ensure predictable builds."
    },
    {
      "line_number": 1,
      "line_content": "FROM ubuntu:latest",
      "rule_id": "BPB8CA77FB",
      "title": "Pin base image versions",
      "severity": "HIGH",
      "message": "Required pattern not found: Check if the FROM instruction specifies an image pinned by digest.",
      "suggestion": "Ensure that the base image in your Dockerfile is pinned to a specific digest to guarantee the use of the same image version across builds. For example, use 'FROM alpine@sha256:12345...' instead of 'FROM alpine:latest' or 'FROM alpine:3.19'."
    },
    {
      "line_number": 2,
      "line_content": "FROM python:3.9 AS builder",
      "rule_id": "BP32CAE590",
      "title": "Choose the right base image",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if the FROM instruction specifies 'scratch' indicating a minimal base.",
      "suggestion": "Avoid using the ':latest' tag for base images to ensure reproducibility. Consider using a minimal base image like 'alpine' for smaller, more secure deployments. Ensure the base image is from a trusted source. For production, use a base image without unnecessary build tools."
    },
    {
      "line_number": 2,
      "line_content": "FROM python:3.9 AS builder",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 2,
      "line_content": "FROM python:3.9 AS builder",
      "rule_id": "BP8E7F00CF",
      "title": "FROM",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if the FROM instruction specifies an Alpine image, potentially with a tag.",
      "suggestion": "Use an official Alpine image as the base for your Dockerfile to minimize size and ensure security. Avoid using the 'latest' tag to ensure predictable builds."
    },
    {
      "line_number": 2,
      "line_content": "FROM python:3.9 AS builder",
      "rule_id": "BPB8CA77FB",
      "title": "Pin base image versions",
      "severity": "HIGH",
      "message": "Required pattern not found: Check if the FROM instruction specifies an image pinned by digest.",
      "suggestion": "Ensure that the base image in your Dockerfile is pinned to a specific digest to guarantee the use of the same image version across builds. For example, use 'FROM alpine@sha256:12345...' instead of 'FROM alpine:latest' or 'FROM alpine:3.19'."
    },
    {
      "line_number": 4,
      "line_content": "RUN apt-get update",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 4,
      "line_content": "RUN apt-get update",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 4,
      "line_content": "RUN apt-get update",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install commands are used together in the same RUN statement.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 4,
      "line_content": "RUN apt-get update",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks for the use of --no-install-recommends with apt-get install to minimize image size.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 5,
      "line_content": "RUN apt-get install -y python3",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 5,
      "line_content": "RUN apt-get install -y python3",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 5,
      "line_content": "RUN apt-get install -y python3",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install commands are used together in the same RUN statement.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 5,
      "line_content": "RUN apt-get install -y python3",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks for the use of --no-install-recommends with apt-get install to minimize image size.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 6,
      "line_content": "RUN apt-get install -y vim nano curl wget",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 6,
      "line_content": "RUN apt-get install -y vim nano curl wget",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 6,
      "line_content": "RUN apt-get install -y vim nano curl wget",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install commands are used together in the same RUN statement.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 6,
      "line_content": "RUN apt-get install -y vim nano curl wget",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks for the use of --no-install-recommends with apt-get install to minimize image size.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 6,
      "line_content": "RUN apt-get install -y vim nano curl wget",
      "rule_id": "BPAF7FDF55",
      "title": "Don't install unnecessary packages",
      "severity": "MEDIUM",
      "message": "Disallowed pattern found: Detects installation of common text editors (nano, vim, emacs) which are unnecessary for most Docker images.",
      "suggestion": "Review the Dockerfile to ensure only necessary packages are installed. Remove any packages that are not essential to run the application, such as text editors or other utilities not required by the application."
    },
    {
      "line_number": 7,
      "line_content": "RUN apt-get install -y nginx",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 7,
      "line_content": "RUN apt-get install -y nginx",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 7,
      "line_content": "RUN apt-get install -y nginx",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install commands are used together in the same RUN statement.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 7,
      "line_content": "RUN apt-get install -y nginx",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks for the use of --no-install-recommends with apt-get install to minimize image size.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 9,
      "line_content": "ADD . /app",
      "rule_id": "BP4F995E92",
      "title": "ADD or COPY",
      "severity": "INFO",
      "message": "Required pattern not found: Checks if ADD is used for adding tar files which will be auto-extracted.",
      "suggestion": "Prefer using COPY for copying local files in the build context. Use ADD for remote URLs and auto-extracting tar files. Review the use of COPY and ADD to ensure they are used appropriately according to their functionalities."
    },
    {
      "line_number": 9,
      "line_content": "ADD . /app",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 10,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 10,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 10,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install commands are used together in the same RUN statement.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 10,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks for the use of --no-install-recommends with apt-get install to minimize image size.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 12,
      "line_content": "RUN apt-get install -y postgresql",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 12,
      "line_content": "RUN apt-get install -y postgresql",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 12,
      "line_content": "RUN apt-get install -y postgresql",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install commands are used together in the same RUN statement.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 12,
      "line_content": "RUN apt-get install -y postgresql",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks for the use of --no-install-recommends with apt-get install to minimize image size.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 14,
      "line_content": "RUN mkdir -p /var/log/myapp",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 14,
      "line_content": "RUN mkdir -p /var/log/myapp",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 14,
      "line_content": "RUN mkdir -p /var/log/myapp",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install commands are used together in the same RUN statement.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 14,
      "line_content": "RUN mkdir -p /var/log/myapp",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks for the use of --no-install-recommends with apt-get install to minimize image size.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 15,
      "line_content": "RUN echo \"log data\" > /var/log/app.log",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 15,
      "line_content": "RUN echo \"log data\" > /var/log/app.log",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 15,
      "line_content": "RUN echo \"log data\" > /var/log/app.log",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install commands are used together in the same RUN statement.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 15,
      "line_content": "RUN echo \"log data\" > /var/log/app.log",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks for the use of --no-install-recommends with apt-get install to minimize image size.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 17,
      "line_content": "WORKDIR app",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 17,
      "line_content": "WORKDIR app",
      "rule_id": "BP9166D7E9",
      "title": "WORKDIR",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if WORKDIR uses an absolute path.",
      "suggestion": "Use WORKDIR with absolute paths instead of RUN cd commands. For example, replace 'RUN cd /app && do-something' with 'WORKDIR /app' followed by 'RUN do-something'."
    },
    {
      "line_number": 19,
      "line_content": "COPY .git /app/.git",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 20,
      "line_content": "COPY README.md /app/",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 21,
      "line_content": "COPY node_modules /app/node_modules",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 23,
      "line_content": "CMD [\"sh\", \"-c\", \"nginx & python3 app.py\"]",
      "rule_id": "BP08E4DA4E",
      "title": "CMD",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if CMD is used in the recommended JSON array format.",
      "suggestion": "Ensure that the CMD instruction is used in the JSON array format, such as CMD [\"executable\", \"param1\", \"param2\"], and that there is only one CMD instruction in the Dockerfile."
    },
    {
      "line_number": 23,
      "line_content": "CMD [\"sh\", \"-c\", \"nginx & python3 app.py\"]",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 25,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 25,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 25,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install commands are used together in the same RUN statement.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 25,
      "line_content": "RUN apt-get install -y redis-server",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks for the use of --no-install-recommends with apt-get install to minimize image size.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 27,
      "line_content": "EXPOSE 22",
      "rule_id": "BP4FB971F0",
      "title": "EXPOSE",
      "severity": "INFO",
      "message": "Required pattern not found: Checks if EXPOSE uses common ports (80, 443 for web servers, 27017 for MongoDB).",
      "suggestion": "Ensure the EXPOSE instruction uses a common, traditional port for the application (e.g., 80 for Apache, 27017 for MongoDB). If your application uses a different port, consider documenting the reason in your Dockerfile or project documentation."
    },
    {
      "line_number": 27,
      "line_content": "EXPOSE 22",
      "rule_id": "BP4FB971F0",
      "title": "EXPOSE",
      "severity": "INFO",
      "message": "Disallowed pattern found: Detects EXPOSE instructions that do not specify a port.",
      "suggestion": "Ensure the EXPOSE instruction uses a common, traditional port for the application (e.g., 80 for Apache, 27017 for MongoDB). If your application uses a different port, consider documenting the reason in your Dockerfile or project documentation."
    },
    {
      "line_number": 27,
      "line_content": "EXPOSE 22",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 28,
      "line_content": "EXPOSE 80",
      "rule_id": "BP4FB971F0",
      "title": "EXPOSE",
      "severity": "INFO",
      "message": "Disallowed pattern found: Detects EXPOSE instructions that do not specify a port.",
      "suggestion": "Ensure the EXPOSE instruction uses a common, traditional port for the application (e.g., 80 for Apache, 27017 for MongoDB). If your application uses a different port, consider documenting the reason in your Dockerfile or project documentation."
    },
    {
      "line_number": 28,
      "line_content": "EXPOSE 80",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 29,
      "line_content": "EXPOSE 3389",
      "rule_id": "BP4FB971F0",
      "title": "EXPOSE",
      "severity": "INFO",
      "message": "Required pattern not found: Checks if EXPOSE uses common ports (80, 443 for web servers, 27017 for MongoDB).",
      "suggestion": "Ensure the EXPOSE instruction uses a common, traditional port for the application (e.g., 80 for Apache, 27017 for MongoDB). If your application uses a different port, consider documenting the reason in your Dockerfile or project documentation."
    },
    {
      "line_number": 29,
      "line_content": "EXPOSE 3389",
      "rule_id": "BP4FB971F0",
      "title": "EXPOSE",
      "severity": "INFO",
      "message": "Disallowed pattern found: Detects EXPOSE instructions that do not specify a port.",
      "suggestion": "Ensure the EXPOSE instruction uses a common, traditional port for the application (e.g., 80 for Apache, 27017 for MongoDB). If your application uses a different port, consider documenting the reason in your Dockerfile or project documentation."
    },
    {
      "line_number": 29,
      "line_content": "EXPOSE 3389",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 31,
      "line_content": "ENV DEBUG=",
      "rule_id": "BP086BFB42",
      "title": "ENV",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if ENV is used to set PATH, ensuring executables are found.",
      "suggestion": "Use ENV to set the PATH environment variable and other necessary environment variables for your application. Ensure sensitive environment variables are unset in the same layer they are used to avoid leaking information in intermediate layers. Consider using a single ENV instruction for setting multiple variables to reduce layers."
    },
    {
      "line_number": 31,
      "line_content": "ENV DEBUG=",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 32,
      "line_content": "ENV APP_VERSION",
      "rule_id": "BP086BFB42",
      "title": "ENV",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if ENV is used to set PATH, ensuring executables are found.",
      "suggestion": "Use ENV to set the PATH environment variable and other necessary environment variables for your application. Ensure sensitive environment variables are unset in the same layer they are used to avoid leaking information in intermediate layers. Consider using a single ENV instruction for setting multiple variables to reduce layers."
    },
    {
      "line_number": 32,
      "line_content": "ENV APP_VERSION",
      "rule_id": "BP086BFB42",
      "title": "ENV",
      "severity": "MEDIUM",
      "message": "Required pattern not found: Checks if ENV is used to set environment variables.",
      "suggestion": "Use ENV to set the PATH environment variable and other necessary environment variables for your application. Ensure sensitive environment variables are unset in the same layer they are used to avoid leaking information in intermediate layers. Consider using a single ENV instruction for setting multiple variables to reduce layers."
    },
    {
      "line_number": 32,
      "line_content": "ENV APP_VERSION",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 34,
      "line_content": "RUN cd /app && \\",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    },
    {
      "line_number": 34,
      "line_content": "RUN cd /app && \\",
      "rule_id": "BP9166D7E9",
      "title": "WORKDIR",
      "severity": "HIGH",
      "message": "Disallowed pattern found: Detects usage of RUN cd which should be replaced with WORKDIR.",
      "suggestion": "Use WORKDIR with absolute paths instead of RUN cd commands. For example, replace 'RUN cd /app && do-something' with 'WORKDIR /app' followed by 'RUN do-something'."
    },
    {
      "line_number": 34,
      "line_content": "RUN cd /app && \\",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Ensures RUN apt-get update and apt-get install commands are used together in the same RUN statement.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 34,
      "line_content": "RUN cd /app && \\",
      "rule_id": "BPAD173E04",
      "title": "RUN",
      "severity": "HIGH",
      "message": "Required pattern not found: Checks for the use of --no-install-recommends with apt-get install to minimize image size.",
      "suggestion": "Ensure RUN instructions that perform complex operations are split across multiple lines using backslashes for better readability. Always combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Manually review the use of pipe (|) operators in RUN instructions to ensure they are preceded by 'set -o pipefail &&' for error handling."
    },
    {
      "line_number": 35,
      "line_content": "    mkdir temp ",
      "rule_id": "BP6EB0C612",
      "title": "USER",
      "severity": "HIGH",
      "message": "Required keyword(s) ('USER') not found. Check if the USER instruction is used at least once to ensure running as a non-root user.",
      "suggestion": "Ensure your Dockerfile includes a USER instruction to switch to a non-root user. Avoid using 'sudo' due to its unpredictable behavior. If necessary, use 'gosu' for privilege escalation. Avoid frequent switching of USER to reduce complexity."
    }
  ]
}