Severity,Line,Rule ID,Rule Title,Message,Suggestion,Line Content
MEDIUM,1,BP086BFB42,ENV,"Due to the linter's limitations, it cannot verify if ENV instructions are used to unset environment variables in a future layer effectively or if they are used in a way that makes version bumps easier. Manual review is required to ensure ENV instructions are used optimally, including the use of ENV for setting paths, providing service-specific variables, and facilitating easy software version updates.","Use ENV to prepend directories to the PATH environment variable to ensure software runs without specifying full paths. Also, use ENV to define necessary environment variables for services and to manage software versions easily. Avoid setting environment variables that should be unset later; instead, use RUN for temporary environment variable changes.",Global Check: Manual Review
MEDIUM,1,BP29F91BA8,Rebuild your images often,"Due to the linter's limitations in understanding Docker build context, flags like --no-cache, and the dynamic nature of image tags over time, this check requires manual review to ensure images are rebuilt often with updated dependencies and without relying on cached layers.","Manually ensure that your Docker images are rebuilt frequently to incorporate updated dependencies and base images. Consider using the --no-cache option during builds to avoid using cached layers and ensure that you are using the most up-to-date versions of base images and dependencies. Additionally, consider pinning base image versions to specific, updated tags to avoid unintended changes.",Global Check: Manual Review
HIGH,1,BP2AA02452,Create ephemeral containers,"Ensuring containers are ephemeral requires a comprehensive understanding of the application's architecture, Dockerfile instructions, and potentially external configurations or scripts that are not discernible on a line-by-line basis. This includes verifying that state is not being stored in the container, ensuring that configurations are passed in at runtime rather than baked into the image, and that the container is designed to be disposable and quickly replaceable without loss of data.","Design your Dockerfile and application to support ephemeral containers. Avoid storing state or data within the container that would be lost upon its destruction. Utilize volumes for data persistence, and inject configuration through environment variables or external configuration files at runtime. Ensure that your container can be easily replaced by a new instance without manual intervention or setup.",Global Check: Manual Review
HIGH,1,BP32CAE590,Choose the right base image,"Due to the linter's limitations, it cannot verify if the chosen base image is from a trusted source, nor can it determine if the image is part of a recognized program. Additionally, choosing a base image for different stages of development (build/test vs. production) requires understanding the application's architecture and dependencies, which is beyond the linter's capabilities.",Choose a minimal base image like 'scratch' or 'alpine' for your Dockerfile to minimize vulnerabilities and ensure it's from a trusted source. Avoid using the ':latest' tag to prevent unexpected changes. Consider manual review to ensure the base image is appropriate for the application's stage of development and security requirements.,Global Check: Manual Review
LOW,1,BP496813AA,Sort multi-line arguments,"Due to the linter's inability to parse Dockerfile structure or understand context across multiple lines, verifying that multi-line arguments are sorted alphanumerically requires manual review.",Manually review multi-line arguments in RUN instructions to ensure they are sorted alphanumerically. This includes checking for alphabetical order and ensuring a space is present before a backslash for line continuation.,Global Check: Manual Review
MEDIUM,1,BP4C08BC02,ONBUILD,"Manual review is required to ensure that ONBUILD instructions are used appropriately, especially when adding resources with ADD or COPY, and to verify that the child Dockerfile can handle the ONBUILD triggers correctly.",Ensure that images intended for use as a base with ONBUILD instructions have an '-onbuild' tag in their FROM line. Verify manually that ONBUILD instructions are used correctly and that child Dockerfiles are prepared for these triggers.,Global Check: Manual Review
MEDIUM,1,BP4F995E92,ADD or COPY,"Due to the linter's limitations, it cannot verify if ADD is used appropriately for remote files only or if COPY is preferred for local files. Manual review is required to ensure the correct use of ADD and COPY instructions based on their specific use cases and advantages.",Use COPY for copying local files and ADD for remote files or tar extraction. Avoid using ADD for local files to prevent unexpected behavior.,Global Check: Manual Review
MEDIUM,1,BP5FE7DA5A,Create reusable stages,"Due to the linter's limitations, it cannot verify if a common stage is defined and reused across multiple stages within the Dockerfile. This requires understanding the Dockerfile's structure and the context of how stages are used, which goes beyond simple line-by-line analysis.",Consider defining a common stage with shared components used by multiple images. Use this as a base for other stages to improve efficiency and maintainability.,Global Check: Manual Review
HIGH,1,BP6EB0C612,USER,"Instruction 'USER' count is 0, which violates the requirement (less than 1). Ensures at least one USER instruction exists to switch from root.","Ensure the Dockerfile includes at least one USER instruction to switch to a non-root user. Avoid using 'sudo' within RUN instructions. Consider manual review for proper user and group setup, appropriate use of 'gosu', and minimizing USER switches.",Global Check: USER Count
HIGH,1,BP6EB0C612,USER,"Due to the linter's limitations, it cannot verify if a non-root user was properly created before switching to it with the USER instruction. Manual review is required to ensure a user and group are correctly established in the Dockerfile.","Ensure the Dockerfile includes at least one USER instruction to switch to a non-root user. Avoid using 'sudo' within RUN instructions. Consider manual review for proper user and group setup, appropriate use of 'gosu', and minimizing USER switches.",Global Check: Manual Review
HIGH,1,BP6EB0C612,USER,The linter cannot assess the use of 'gosu' for scenarios where sudo-like functionality is absolutely necessary. This requires manual review to ensure 'gosu' is used appropriately instead of 'sudo'.,"Ensure the Dockerfile includes at least one USER instruction to switch to a non-root user. Avoid using 'sudo' within RUN instructions. Consider manual review for proper user and group setup, appropriate use of 'gosu', and minimizing USER switches.",Global Check: Manual Review
HIGH,1,BP6EB0C612,USER,Switching USER back and forth can introduce complexity and additional layers. This pattern requires manual review as the linter cannot track USER instruction usage frequency or context.,"Ensure the Dockerfile includes at least one USER instruction to switch to a non-root user. Avoid using 'sudo' within RUN instructions. Consider manual review for proper user and group setup, appropriate use of 'gosu', and minimizing USER switches.",Global Check: Manual Review
HIGH,1,BP9F076259,Leverage build cache,"Due to the linter's inability to understand Dockerfile structure, instruction order, or context across multiple instructions, assessing the effective use of the build cache requires manual review. This includes verifying that instructions are ordered from less frequently changed to more frequently changed to maximize cache utilization, and ensuring that cache busting is done intentionally.","Review your Dockerfile to ensure instructions are ordered to maximize cache reuse. Instructions that change less frequently should be placed before those that change more frequently. Additionally, avoid unnecessary cache busting by carefully managing instruction changes.",Global Check: Manual Review
MEDIUM,1,BPAD173E04,RUN,"Due to the linter's limitations, it cannot verify if multi-line RUN commands are properly formatted with logical operators or if here documents are used correctly. Manual review is required to ensure complex RUN statements are readable and maintainable.",Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,Global Check: Manual Review
HIGH,1,BPAEDF7F2F,Exclude with .dockerignore,Required file not found: '.dockerignore'. Check if a .dockerignore file exists in the same directory as the Dockerfile.,"Create a .dockerignore file in the same directory as your Dockerfile to exclude files not relevant to the build, such as temporary files or version control directories. This helps to reduce the build context size and improve build performance.",Global Check: File '.dockerignore'
HIGH,1,BPD5DA0774,Build and test your images in CI,Automated checks cannot verify if Docker images are built and tested in a CI/CD pipeline like GitHub Actions due to the linter's inability to access external CI/CD configuration files or understand complex workflows.,"Ensure your project's CI/CD pipeline configuration (e.g., .github/workflows/docker.yml for GitHub Actions) includes steps to build the Docker image and run tests on every commit or pull request.",Global Check: Manual Review
MEDIUM,1,BPDE4F1AAB,VOLUME,"Instruction 'VOLUME' count is 0, which violates the requirement (less than 1). Ensures at least one VOLUME instruction exists to expose mutable or user-serviceable parts of the image.","Add at least one VOLUME instruction to your Dockerfile to expose any database storage area, configuration storage, or files/folders created by your Docker container.",Global Check: VOLUME Count
HIGH,1,BPFAEF57A2,ENTRYPOINT,"Instruction 'ENTRYPOINT' count is 0, which violates the requirement (less than 1). Ensures at least one ENTRYPOINT instruction exists.",Ensure your Dockerfile contains an ENTRYPOINT instruction to define the container's main command. Use CMD to provide default flags for the ENTRYPOINT. There should be exactly one ENTRYPOINT and at most one CMD instruction.,Global Check: ENTRYPOINT Count
HIGH,1,BPFE9F359F,Decouple applications,"Due to the linter's inability to understand application architecture, decoupling of applications, or the context across multiple lines and Docker instructions, this best practice requires a manual review to ensure each container is focused on a single concern and properly decoupled from other application components.","Review your Dockerfile and application architecture to ensure that each container is dedicated to a single concern. If your application consists of multiple components (e.g., web server, database, cache), consider splitting these into separate containers to facilitate scaling and improve maintainability. Utilize Docker container networks for inter-container communication.",Global Check: Manual Review
HIGH,1,BP32CAE590,Choose the right base image,Required pattern not found: Checks if the FROM instruction specifies 'scratch' for minimal base image. (Expected pattern: '^\s*FROM\s+scratch$'),Choose a minimal base image like 'scratch' or 'alpine' for your Dockerfile to minimize vulnerabilities and ensure it's from a trusted source. Avoid using the ':latest' tag to prevent unexpected changes. Consider manual review to ensure the base image is appropriate for the application's stage of development and security requirements.,FROM ubuntu:latest
HIGH,1,BP32CAE590,Choose the right base image,Required pattern not found: Checks if the FROM instruction uses 'alpine' for a minimal base image. (Expected pattern: '^\s*FROM\s+alpine'),Choose a minimal base image like 'scratch' or 'alpine' for your Dockerfile to minimize vulnerabilities and ensure it's from a trusted source. Avoid using the ':latest' tag to prevent unexpected changes. Consider manual review to ensure the base image is appropriate for the application's stage of development and security requirements.,FROM ubuntu:latest
HIGH,1,BP32CAE590,Choose the right base image,Disallowed pattern found: Using 'latest' tag for base image.,Choose a minimal base image like 'scratch' or 'alpine' for your Dockerfile to minimize vulnerabilities and ensure it's from a trusted source. Avoid using the ':latest' tag to prevent unexpected changes. Consider manual review to ensure the base image is appropriate for the application's stage of development and security requirements.,FROM ubuntu:latest
MEDIUM,1,BP4C08BC02,ONBUILD,Required pattern not found: Checks if the FROM instruction specifies an image with an '-onbuild' tag. (Expected pattern: '^\s*FROM\s+[^\s]+-onbuild\b'),Ensure that images intended for use as a base with ONBUILD instructions have an '-onbuild' tag in their FROM line. Verify manually that ONBUILD instructions are used correctly and that child Dockerfiles are prepared for these triggers.,FROM ubuntu:latest
HIGH,1,BP8E7F00CF,FROM,"Required pattern not found: Checks if the FROM instruction specifies an Alpine image, potentially with a version tag. (Expected pattern: '^\s*FROM\s+alpine(:[\w.-]+)?\s*(#.*)?$')",Use an official Alpine image as the base for your Dockerfile to minimize size and ensure security. Avoid using the 'latest' tag to make builds more predictable.,FROM ubuntu:latest
HIGH,1,BP8E7F00CF,FROM,Disallowed pattern found: Detects usage of the 'latest' tag which should be avoided for more predictable builds.,Use an official Alpine image as the base for your Dockerfile to minimize size and ensure security. Avoid using the 'latest' tag to make builds more predictable.,FROM ubuntu:latest
HIGH,1,BPB8CA77FB,Pin base image versions,Required pattern not found: Check if the FROM instruction specifies an image pinned by digest. (Expected pattern: '^\s*FROM\s+[\w\d.-]+(@sha256:[a-f0-9]{64})\s*(?:\s+|$)'),Ensure that the base image in the FROM instruction is pinned to a specific digest to guarantee reproducibility and avoid unexpected changes.,FROM ubuntu:latest
HIGH,2,BP32CAE590,Choose the right base image,Required pattern not found: Checks if the FROM instruction specifies 'scratch' for minimal base image. (Expected pattern: '^\s*FROM\s+scratch$'),Choose a minimal base image like 'scratch' or 'alpine' for your Dockerfile to minimize vulnerabilities and ensure it's from a trusted source. Avoid using the ':latest' tag to prevent unexpected changes. Consider manual review to ensure the base image is appropriate for the application's stage of development and security requirements.,FROM python:3.9 AS builder
HIGH,2,BP32CAE590,Choose the right base image,Required pattern not found: Checks if the FROM instruction uses 'alpine' for a minimal base image. (Expected pattern: '^\s*FROM\s+alpine'),Choose a minimal base image like 'scratch' or 'alpine' for your Dockerfile to minimize vulnerabilities and ensure it's from a trusted source. Avoid using the ':latest' tag to prevent unexpected changes. Consider manual review to ensure the base image is appropriate for the application's stage of development and security requirements.,FROM python:3.9 AS builder
MEDIUM,2,BP4C08BC02,ONBUILD,Required pattern not found: Checks if the FROM instruction specifies an image with an '-onbuild' tag. (Expected pattern: '^\s*FROM\s+[^\s]+-onbuild\b'),Ensure that images intended for use as a base with ONBUILD instructions have an '-onbuild' tag in their FROM line. Verify manually that ONBUILD instructions are used correctly and that child Dockerfiles are prepared for these triggers.,FROM python:3.9 AS builder
HIGH,2,BP8E7F00CF,FROM,"Required pattern not found: Checks if the FROM instruction specifies an Alpine image, potentially with a version tag. (Expected pattern: '^\s*FROM\s+alpine(:[\w.-]+)?\s*(#.*)?$')",Use an official Alpine image as the base for your Dockerfile to minimize size and ensure security. Avoid using the 'latest' tag to make builds more predictable.,FROM python:3.9 AS builder
HIGH,2,BPB8CA77FB,Pin base image versions,Required pattern not found: Check if the FROM instruction specifies an image pinned by digest. (Expected pattern: '^\s*FROM\s+[\w\d.-]+(@sha256:[a-f0-9]{64})\s*(?:\s+|$)'),Ensure that the base image in the FROM instruction is pinned to a specific digest to guarantee reproducibility and avoid unexpected changes.,FROM python:3.9 AS builder
MEDIUM,4,BPAD173E04,RUN,Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability. (Expected pattern: '^\s*RUN\s+.*\\$'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN apt-get update
MEDIUM,4,BPAD173E04,RUN,Required pattern not found: Ensures apt-get install commands include the --no-install-recommends flag. (Expected pattern: '^\s*RUN\s+.*--no-install-recommends'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN apt-get update
MEDIUM,5,BPAD173E04,RUN,Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability. (Expected pattern: '^\s*RUN\s+.*\\$'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN apt-get install -y python3
MEDIUM,5,BPAD173E04,RUN,Required pattern not found: Ensures apt-get install commands include the --no-install-recommends flag. (Expected pattern: '^\s*RUN\s+.*--no-install-recommends'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN apt-get install -y python3
MEDIUM,6,BPAD173E04,RUN,Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability. (Expected pattern: '^\s*RUN\s+.*\\$'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN apt-get install -y vim nano curl wget
MEDIUM,6,BPAD173E04,RUN,Required pattern not found: Ensures apt-get install commands include the --no-install-recommends flag. (Expected pattern: '^\s*RUN\s+.*--no-install-recommends'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN apt-get install -y vim nano curl wget
MEDIUM,6,BPAF7FDF55,Don't install unnecessary packages,"Disallowed keyword(s) found ('vim', 'nano', 'emacs'). Checks for the installation of common text editors which are usually unnecessary in production images.",Review the Dockerfile to ensure only necessary packages are installed. Consider using multi-stage builds to include tools needed for building your application but not required in the final image.,RUN apt-get install -y vim nano curl wget
MEDIUM,7,BPAD173E04,RUN,Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability. (Expected pattern: '^\s*RUN\s+.*\\$'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN apt-get install -y nginx
MEDIUM,7,BPAD173E04,RUN,Required pattern not found: Ensures apt-get install commands include the --no-install-recommends flag. (Expected pattern: '^\s*RUN\s+.*--no-install-recommends'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN apt-get install -y nginx
MEDIUM,10,BPAD173E04,RUN,Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability. (Expected pattern: '^\s*RUN\s+.*\\$'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN apt-get install -y redis-server
MEDIUM,10,BPAD173E04,RUN,Required pattern not found: Ensures apt-get install commands include the --no-install-recommends flag. (Expected pattern: '^\s*RUN\s+.*--no-install-recommends'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN apt-get install -y redis-server
MEDIUM,12,BPAD173E04,RUN,Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability. (Expected pattern: '^\s*RUN\s+.*\\$'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN apt-get install -y postgresql
MEDIUM,12,BPAD173E04,RUN,Required pattern not found: Ensures apt-get install commands include the --no-install-recommends flag. (Expected pattern: '^\s*RUN\s+.*--no-install-recommends'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN apt-get install -y postgresql
MEDIUM,14,BPAD173E04,RUN,Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability. (Expected pattern: '^\s*RUN\s+.*\\$'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN mkdir -p /var/log/myapp
MEDIUM,14,BPAD173E04,RUN,Required pattern not found: Ensures apt-get install commands include the --no-install-recommends flag. (Expected pattern: '^\s*RUN\s+.*--no-install-recommends'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN mkdir -p /var/log/myapp
MEDIUM,15,BPAD173E04,RUN,Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability. (Expected pattern: '^\s*RUN\s+.*\\$'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,"RUN echo ""log data"" > /var/log/app.log"
MEDIUM,15,BPAD173E04,RUN,Required pattern not found: Ensures apt-get install commands include the --no-install-recommends flag. (Expected pattern: '^\s*RUN\s+.*--no-install-recommends'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,"RUN echo ""log data"" > /var/log/app.log"
HIGH,17,BP9166D7E9,WORKDIR,Disallowed pattern found: Detects WORKDIR using a relative path.,"Use absolute paths when setting the WORKDIR. For example, use WORKDIR /app instead of WORKDIR app.",WORKDIR app
MEDIUM,25,BPAD173E04,RUN,Required pattern not found: Checks if RUN commands are split across multiple lines using backslashes for readability. (Expected pattern: '^\s*RUN\s+.*\\$'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN apt-get install -y redis-server
MEDIUM,25,BPAD173E04,RUN,Required pattern not found: Ensures apt-get install commands include the --no-install-recommends flag. (Expected pattern: '^\s*RUN\s+.*--no-install-recommends'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN apt-get install -y redis-server
INFO,27,BP4FB971F0,EXPOSE,"Required pattern not found: Checks if EXPOSE uses common ports (80, 443 for web servers, 27017 for MongoDB). (Expected pattern: '^\s*EXPOSE\s+(80|443|27017)\s*$')","Ensure the EXPOSE instruction uses a common, traditional port for the application it serves. For example, use 'EXPOSE 80' for Apache web server images, 'EXPOSE 27017' for MongoDB images.",EXPOSE 22
INFO,29,BP4FB971F0,EXPOSE,"Required pattern not found: Checks if EXPOSE uses common ports (80, 443 for web servers, 27017 for MongoDB). (Expected pattern: '^\s*EXPOSE\s+(80|443|27017)\s*$')","Ensure the EXPOSE instruction uses a common, traditional port for the application it serves. For example, use 'EXPOSE 80' for Apache web server images, 'EXPOSE 27017' for MongoDB images.",EXPOSE 3389
MEDIUM,31,BP086BFB42,ENV,Required pattern not found: Checks if ENV is used to correctly prepend to the PATH environment variable. (Expected pattern: '^\s*ENV\s+PATH=.+?:\$PATH'),"Use ENV to prepend directories to the PATH environment variable to ensure software runs without specifying full paths. Also, use ENV to define necessary environment variables for services and to manage software versions easily. Avoid setting environment variables that should be unset later; instead, use RUN for temporary environment variable changes.",ENV DEBUG=
MEDIUM,31,BP086BFB42,ENV,Required pattern not found: Ensures ENV is used to set environment variables. (Expected pattern: '^\s*ENV\s+\w+=.+'),"Use ENV to prepend directories to the PATH environment variable to ensure software runs without specifying full paths. Also, use ENV to define necessary environment variables for services and to manage software versions easily. Avoid setting environment variables that should be unset later; instead, use RUN for temporary environment variable changes.",ENV DEBUG=
MEDIUM,32,BP086BFB42,ENV,Required pattern not found: Checks if ENV is used to correctly prepend to the PATH environment variable. (Expected pattern: '^\s*ENV\s+PATH=.+?:\$PATH'),"Use ENV to prepend directories to the PATH environment variable to ensure software runs without specifying full paths. Also, use ENV to define necessary environment variables for services and to manage software versions easily. Avoid setting environment variables that should be unset later; instead, use RUN for temporary environment variable changes.",ENV APP_VERSION
MEDIUM,32,BP086BFB42,ENV,Required pattern not found: Ensures ENV is used to set environment variables. (Expected pattern: '^\s*ENV\s+\w+=.+'),"Use ENV to prepend directories to the PATH environment variable to ensure software runs without specifying full paths. Also, use ENV to define necessary environment variables for services and to manage software versions easily. Avoid setting environment variables that should be unset later; instead, use RUN for temporary environment variable changes.",ENV APP_VERSION
MEDIUM,34,BPAD173E04,RUN,Required pattern not found: Ensures apt-get install commands include the --no-install-recommends flag. (Expected pattern: '^\s*RUN\s+.*--no-install-recommends'),Ensure long or complex RUN instructions are split across multiple lines using backslashes for better readability. Combine apt-get update with apt-get install in the same RUN statement to avoid caching issues. Use --no-install-recommends with apt-get install to minimize the image size. Review complex RUN statements manually for proper formatting and maintainability.,RUN cd /app && \
